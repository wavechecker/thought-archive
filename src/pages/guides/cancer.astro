---
import { getCollection } from "astro:content";

// ðŸ” EDIT THIS ONE LINE PER HUB
const CATEGORY = "cancer";

const all = await getCollection("guides");
const guides = all
  .filter(({ data }) =>
    data.draft !== true && (
      data.category === CATEGORY ||
      (Array.isArray(data.tags) && data.tags.includes(CATEGORY))
    )
  )
  .sort((a, b) => {
    const da = new Date(a.data.updatedDate ?? a.data.publishDate ?? 0).valueOf();
    const db = new Date(b.data.updatedDate ?? b.data.publishDate ?? 0).valueOf();
    return db - da || a.data.title.localeCompare(b.data.title);
  });

// Optional: set a nice page title/description for each hub
const PAGE_TITLE = `${CATEGORY} â€” Guide Hub`;
const PAGE_DESC = `Browse patient-friendly guides for ${CATEGORY}.`;
---

<html lang="en">
  <head>
    <title>{PAGE_TITLE}</title>
    <meta name="description" content={PAGE_DESC} />
  </head>
  <body>
    <h1>{PAGE_TITLE}</h1>
    <p>{PAGE_DESC}</p>

    {guides.length === 0 ? (
      <p>No guides found yet.</p>
    ) : (
      <ul>
        {guides.map(g => (
          <li>
            <a href={`/guides/${g.data.slug}`}>{g.data.title}</a>
            {g.data.description && <small> â€” {g.data.description}</small>}
          </li>
        ))}
      </ul>
    )}
  </body>
</html>

---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("posts");

// Sort newest first (by publishDate)
posts.sort((a, b) => {
  const da = new Date(a.data.publishDate || 0).getTime();
  const db = new Date(b.data.publishDate || 0).getTime();
  return db - da;
});
---

<Layout title="Posts">
  <h1 class="text-3xl font-semibold mb-6">Posts</h1>
  <ul class="space-y-3">
    {posts.map((p) => (
      <li>
        <a href={`/posts/${p.slug}/`} class="underline hover:no-underline">
          {p.data.title ?? p.slug}
        </a>
        {p.data.publishDate ? (
          <span class="text-sm text-gray-500"> â€” {p.data.publishDate}</span>
        ) : null}
      </li>
    ))}
  </ul>
</Layout>

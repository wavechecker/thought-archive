---
export const prerender = true;

import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// Fetch & sort newest first (pubDate is a Date because of z.coerce.date())
const posts = (await getCollection('posts'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

// Pretty date like "Aug 7, 2025"
const fmt = (d: Date) =>
  new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric', year: 'numeric' }).format(d);
---

<Layout>
  <h1>All Posts</h1>
  <ul>
    {posts.map((post) => (
      <li>
        <a href={`/posts/${post.slug}`}>{post.data.title}</a>
        <small> â€” {fmt(post.data.pubDate)}</small>
      </li>
    ))}
  </ul>
</Layout>



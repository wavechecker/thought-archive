---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

// Build all /posts/* pages at build time
export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

// Receive the entry from getStaticPaths
const { entry } = Astro.props as { entry: any };
const { Content } = await entry.render();
const data = entry.data;

// Title for the page/tab
const pageTitle = data.title ?? entry.slug;
---

<Layout title={pageTitle}>
  <article class="prose max-w-none">
    <h1>{data.title ?? entry.slug}</h1>
    {data.pubDate && <p><em>{new Date(data.pubDate).toDateString()}</em></p>}
    {data.description && <p>{data.description}</p>}
    <Content />
  </article>
</Layout>

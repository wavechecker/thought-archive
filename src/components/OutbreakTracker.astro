---
const {
  title = "Current Measles Situation",
  region = "United States",
  dataUrl = "/data/measles-us.json",
  cases,
  statesAffected,
  hospitalizations,
  deaths,
  lastUpdated,
  sourceName = "CDC",
  sourceUrl = "https://www.cdc.gov/measles/cases-outbreaks.html",
} = Astro.props;
---

<div
  class="border-l-4 border-red-600 bg-red-50 p-4 rounded-2xl shadow-sm mb-6"
  data-outbreak
  data-url={dataUrl}
>
  <h3 class="font-semibold text-red-700">
    {title} — {region}
  </h3>

  <p class="text-sm mt-1">
    <strong data-field="cases">
      {typeof cases === "number" ? cases.toLocaleString() : "—"}
    </strong> confirmed cases
    <span data-field="statesLine" style="display:none">
      {" "}across <strong data-field="statesAffected">—</strong> states
    </span>.
  </p>

  <ul class="text-sm mt-2 list-disc ml-5">
    {typeof hospitalizations === "number" && (
      <li>Hospitalizations: <strong data-field="hospitalizations">{hospitalizations.toLocaleString()}</strong></li>
    )}
    {typeof deaths === "number" && (
      <li>Deaths: <strong data-field="deaths">{deaths.toLocaleString()}</strong></li>
    )}
  </ul>

  <p class="text-xs text-gray-600 mt-2">
    <span>Last updated <span data-field="lastUpdated">{lastUpdated ?? "—"}</span></span>
    {" · "}
    Source:
    {sourceUrl ? (
      <a href={sourceUrl} class="underline" rel="noopener noreferrer">{sourceName}</a>
    ) : (
      <span>{sourceName}</span>
    )}
  </p>
</div>

<!-- Load the external client script once per page; Astro will dedupe identical tags -->
<script type="module" src="/js/outbreak-tracker.js"></script>
